# 3_1_GPIO_input

***
在本篇文章中，介绍 *GPIOI* 输入中的两种经典控制方式——**按键控制和传感器控制**。
***

# 一、*GPIO* 输入模式回顾
&emsp;&emsp;在*stm32*的*GPIO*中，已经内置了上拉电阻和下拉电阻，通过配置，允许的的输入模式有四种：浮空、上拉、下拉、模拟输入。配置完成之后，各个模式特点如下：

- 浮空输入：无上下拉，需要外部电路提供明确的高低电平，否则输入就是不确定的；
- 上拉输入：设置了上拉电阻，无外部输入时读取到高电平；
- 下拉输入：设置了下拉电阻，无外部输入时读取到电平；

# 二、*GPIO* 输入控制之按键控制
&emsp;&emsp;**按键**是一种常见的输入设备，按下导通，松手断开；

&emsp;&emsp;由于按键内部使用机械式弹簧片进行通断，所以按下和松手的瞬间有一连串的抖动，表现为波形的浮动：
![文件](https://github.com/Hi-Guo-Phy/Introduction-to-STM32F103C8T6/blob/main/Images/2_8_1.png)

&emsp;&emsp;为了消除这种抖动，我们从软件的角度可以直接将抖动所需时间——5~10ms 延时过去即可。

# 三、*GPIO* 输入控制之传感器控制
## 1. 传感器介绍
&emsp;&emsp;传感器元件的核心部分是**光敏电阻、热敏电阻、红外接收管**等会受到外部环境因素变化而发生相应变化的器件。

&emsp;&emsp;例如光敏电阻，它的特性是——光照强度越高，电阻值越低；光照强度越低，电阻值越高。

## 2. 光敏电阻模块（适用于其他类型模块）
&emsp;&emsp;光敏电阻模块电路如下：
![文件](https://github.com/Hi-Guo-Phy/Introduction-to-STM32F103C8T6/blob/main/Images/2_8_2.png)

我们需要知道的是，传感器模块相对于我们的*stm32*核心板而言，**是一个外部器件**，我们使用**GPIO**读取到的输入，是这个模块的输出。

&emsp;&emsp;上图中最右侧，是这个模块的四个排针，抑或者四个接口：
- **VCC**：电源正极；
- **GND**：地；
- **AO**：模块的模拟输出，相对于**GPIO**，就是输入；
- **DO**：模块的数字输出。

## 3. 光敏电阻模块的电路分析
&emsp;&emsp;首先我们需要知道的是，如果电路中出现了某个电容，一端接地、一端接供电端口，那么这个电容极有可能就是个滤波电容，起到稳定电路的作用，分析电路时可以先不管。

&emsp;&emsp;第一部分是核心原件——光敏电阻所在电路，**用于生成模拟输出**：
![文件](https://github.com/Hi-Guo-Phy/Introduction-to-STM32F103C8T6/blob/main/Images/2_8_3.png)
当外部环境发生变化，**N1**的阻值就发生了变换，借助于另一个定值电阻的分压，可以通过**AO**引脚输出不同的模拟电压，我们进行极限情况分析：
- **N1**阻值极大，电路相当于断路，**AO**输出电压**VCC**；
- **N1**阻值极小，电路相当于短路，**AO**输出电压**GND**；

&emsp;&emsp;第二部分是电压比较器所在电路，**用于生成数字输出**：
![文件](https://github.com/Hi-Guo-Phy/Introduction-to-STM32F103C8T6/blob/main/Images/2_8_4.png)
电压比较器原理很简单，不再详细叙述。

&emsp;&emsp;第三部分是外围电路，用于放置**LED**指示灯以及其余部分：
![文件](https://github.com/Hi-Guo-Phy/Introduction-to-STM32F103C8T6/blob/main/Images/2_8_5.png)
这里的两个**LED**用于通电指示，其余接口不必详述。



